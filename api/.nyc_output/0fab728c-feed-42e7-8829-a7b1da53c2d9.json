{"/home/gabriel/NG-Cash_desafio/api/src/controllers/AccountsController.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/controllers/AccountsController.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":56}},"2":{"start":{"line":6,"column":8},"end":{"line":6,"column":33}},"3":{"start":{"line":9,"column":39},"end":{"line":9,"column":42}},"4":{"start":{"line":10,"column":23},"end":{"line":10,"column":60}},"5":{"start":{"line":11,"column":8},"end":{"line":11,"column":68}},"6":{"start":{"line":14,"column":0},"end":{"line":14,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":26},"end":{"line":7,"column":5}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":35},"end":{"line":12,"column":5}},"line":8}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":2,"4":2,"5":2,"6":1},"f":{"0":1,"1":2},"b":{},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/controllers/AccountsController.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/controllers/AccountsController.ts"],"names":[],"mappings":";;AAGA,yDAAgD;AAEhD,MAAqB,kBAAkB;IAErC,YAAoB,QAAwB;QAAxB,aAAQ,GAAR,QAAQ,CAAgB;IAAG,CAAC;IAEhD,KAAK,CAAC,OAAO,CAAC,GAAY,EAAE,GAAa,EAAE,KAAmB;QAC5D,MAAM,EAAE,IAAI,EAAE,EAAE,QAAQ,EAAE,EAAE,GAAG,GAAG,CAAC;QACnC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QACrD,GAAG,CAAC,MAAM,CAAC,+BAAW,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC1C,CAAC;CACF;AATD,qCASC","sourcesContent":["import { Request, Response, NextFunction } from 'express';\nimport AccountService from '../services/AccountService';\nimport { Controller } from '../interfaces/Controller';\nimport { StatusCodes } from 'http-status-codes';\n\nexport default class AccountsController implements \nOmit<Controller, 'read' | 'create' | 'update' | 'delete'> {\n  constructor(private _service: AccountService) {}\n  \n  async readOne(req: Request, res: Response, _next: NextFunction): Promise<void> {\n    const { user: { username } } = req;\n    const result = await this._service.readOne(username);\n    res.status(StatusCodes.OK).json(result);\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f227b2d4428ab3d30d08548e8f8fc1d7f0a8ddd1","contentHash":"537833c43bf1f4cd34f0fe6f43cab5ac6cab1763b23557f9ddea6ce0c24afc0c"},"/home/gabriel/NG-Cash_desafio/api/src/services/AccountService.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/services/AccountService.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":19},"end":{"line":6,"column":74}},"4":{"start":{"line":7,"column":16},"end":{"line":7,"column":68}},"5":{"start":{"line":10,"column":8},"end":{"line":10,"column":37}},"6":{"start":{"line":11,"column":8},"end":{"line":11,"column":35}},"7":{"start":{"line":14,"column":23},"end":{"line":25,"column":10}},"8":{"start":{"line":26,"column":8},"end":{"line":26,"column":22}},"9":{"start":{"line":29,"column":8},"end":{"line":33,"column":11}},"10":{"start":{"line":34,"column":8},"end":{"line":38,"column":11}},"11":{"start":{"line":41,"column":0},"end":{"line":41,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":78},"end":{"line":12,"column":5}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":4},"end":{"line":13,"column":5}},"loc":{"start":{"line":13,"column":28},"end":{"line":27,"column":5}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":28,"column":4},"end":{"line":28,"column":5}},"loc":{"start":{"line":28,"column":51},"end":{"line":39,"column":5}},"line":28}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":9,"column":16},"end":{"line":9,"column":44}},"type":"default-arg","locations":[{"start":{"line":9,"column":29},"end":{"line":9,"column":44}}],"line":9},"4":{"loc":{"start":{"line":9,"column":46},"end":{"line":9,"column":76}},"type":"default-arg","locations":[{"start":{"line":9,"column":58},"end":{"line":9,"column":76}}],"line":9}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":1},"f":{"0":2,"1":1,"2":0,"3":0},"b":{"0":[1,1,1],"1":[2,0],"2":[2,2],"3":[1],"4":[1]},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/services/AccountService.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/services/AccountService.ts"],"names":[],"mappings":";;;;;AAAA,2EAAmD;AACnD,qEAA6C;AAK7C,MAAqB,cAAc;IAGjC,YAAoB,aAAa,eAAK,EAAU,YAAY,kBAAQ;QAAhD,eAAU,GAAV,UAAU,CAAQ;QAAU,cAAS,GAAT,SAAS,CAAW;IAAG,CAAC;IACxE,KAAK,CAAC,OAAO,CAAC,QAAgB;QAC5B,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC;YAC3C,KAAK,EAAE;gBACL,QAAQ;aACT;YACD,UAAU,EAAE;gBACV,OAAO,EAAE,CAAC,UAAU,CAAC;aACtB;YACD,OAAO,EAAE;gBACP,KAAK,EAAE,kBAAQ;gBACf,EAAE,EAAE,SAAS;aACd;SACF,CAAC,CAAC;QACH,OAAO,MAA6B,CAAC;IACvC,CAAC;IAED,KAAK,CAAC,QAAQ,CAAC,MAAa,EAAG,WAAkB,EAAE,MAAa,EAAE,CAAc;QAC9E,MAAM,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,EAAE;YACxC,EAAE,EAAE,MAAM;YACV,KAAK,EAAE,EAAE,EAAE,EAAE,MAAM,EAAE;YACrB,WAAW,EAAE,CAAC;SAAC,CAAC,CAAC;QACnB,MAAM,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,SAAS,EAAE;YACxC,EAAE,EAAE,MAAM;YACV,KAAK,EAAE,EAAE,EAAE,EAAE,WAAW,EAAE;YAC1B,WAAW,EAAE,CAAC;SAAC,CAAC,CAAC;IACrB,CAAC;CACF;AA9BD,iCA8BC","sourcesContent":["import Accounts from '../database/models/Accounts';\nimport Users from '../database/models/Users';\nimport { IBalance } from '../interfaces/IBalance';\nimport { Service } from '../interfaces/Service';\nimport { Transaction } from 'sequelize';\n\nexport default class AccountService \nimplements Omit<Service<IBalance>, 'read' | 'create' | 'readOne' | 'delete'> \n{\n  constructor(private _userModel = Users, private _accModel = Accounts) {}\n  async readOne(username: string): Promise<IBalance> {\n    const result = await this._userModel.findOne({\n      where: {\n        username,\n      },\n      attributes: {\n        exclude: ['password']\n      },\n      include: {\n        model: Accounts,\n        as: 'account',\n      }\n    });\n    return result as unknown as IBalance;\n  }\n\n  async transfer(userId:number , addresseeId:number, amount:number, t: Transaction) {\n    await this._accModel.decrement('balance', { \n      by: amount, \n      where: { id: userId }, \n      transaction: t});\n    await this._accModel.increment('balance', { \n      by: amount, \n      where: { id: addresseeId }, \n      transaction: t});\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e2b124b2f7e5de4f01edfc21ff2b20341e77bccb","contentHash":"69251a150dceb07b5afce85902a9d419710ffd502c8fb7bff9a13fe26dbc8ec8"},"/home/gabriel/NG-Cash_desafio/api/src/database/models/Accounts.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/database/models/Accounts.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":20},"end":{"line":6,"column":40}},"4":{"start":{"line":7,"column":11},"end":{"line":7,"column":40}},"5":{"start":{"line":10,"column":0},"end":{"line":25,"column":3}},"6":{"start":{"line":26,"column":0},"end":{"line":26,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1},"f":{"0":1},"b":{"0":[1,1,1],"1":[1,0],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/database/models/Accounts.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/database/models/Accounts.ts"],"names":[],"mappings":";;;;;AAAA,yCAEmB;AACnB,yCAAmB;AAEnB,MAAM,QAAS,SAAQ,iBAAK;CAG3B;AACD,QAAQ,CAAC,IAAI,CAAC;IACZ,EAAE,EAAE;QACF,IAAI,EAAE,qBAAS,CAAC,OAAO;QACvB,SAAS,EAAE,KAAK;QAChB,UAAU,EAAE,IAAI;QAChB,aAAa,EAAE,IAAI;KACpB;IACD,OAAO,EAAE;QACP,IAAI,EAAE,qBAAS,CAAC,OAAO,CAAC,EAAE,EAAC,CAAC,CAAC;QAC7B,YAAY,EAAE,MAAM;KACrB;CACF,EAAE;IACD,SAAS,EAAE,UAAE;IACb,SAAS,EAAE,UAAU;IACrB,UAAU,EAAE,KAAK;CAClB,CAAC,CAAC;AAEH,kBAAe,QAAQ,CAAC","sourcesContent":["import {\n  Model, DataTypes,\n} from 'sequelize';\nimport db from '.';\n\nclass Accounts extends Model {\n  public id!: number;\n  public balance!: number;\n}\nAccounts.init({\n  id: {\n    type: DataTypes.INTEGER,\n    allowNull: false,\n    primaryKey: true,\n    autoIncrement: true,\n  },\n  balance: {\n    type: DataTypes.DECIMAL(15,2),\n    defaultValue: 100.00,\n  },\n}, {\n  sequelize: db,\n  modelName: 'accounts',\n  timestamps: false,\n});\n\nexport default Accounts;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ba34047242283b88eaadebc564c141a082b02b33","contentHash":"57d5c69be693dd1de0944b6999111449dda31df239bc174e73b646afa8782427"},"/home/gabriel/NG-Cash_desafio/api/src/database/models/index.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/database/models/index.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":20},"end":{"line":26,"column":40}},"26":{"start":{"line":27,"column":15},"end":{"line":27,"column":58}},"27":{"start":{"line":28,"column":0},"end":{"line":28,"column":52}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21}},"s":{"0":1,"1":6,"2":6,"3":6,"4":6,"5":6,"6":16,"7":6,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":1,"15":1,"16":0,"17":1,"18":1,"19":1,"20":6,"21":6,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1},"f":{"0":6,"1":16,"2":0,"3":1,"4":0,"5":1},"b":{"0":[1,1,1],"1":[1,0],"2":[6,0],"3":[6,0],"4":[6,6],"5":[0,6],"6":[6,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,1],"13":[1,0],"14":[6,0],"15":[6,6]},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/database/models/index.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/database/models/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA,yCAAsC;AACtC,2DAA6C;AAE7C,kBAAe,IAAI,qBAAS,CAAC,MAAM,CAAC,CAAC","sourcesContent":["import { Sequelize } from 'sequelize';\nimport * as config from '../config/database';\n\nexport default new Sequelize(config);"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8f449203aa2a92c60eb6f85b5a703b9e96124ae4","contentHash":"3a8b22fb0ce92ea54507fa9759615344071f99d2749b192e5ae85e44aba00661"},"/home/gabriel/NG-Cash_desafio/api/src/database/config/database.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/database/config/database.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":25}},"2":{"start":{"line":4,"column":15},"end":{"line":11,"column":1}},"3":{"start":{"line":12,"column":0},"end":{"line":12,"column":24}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":5,"column":14},"end":{"line":5,"column":43}},"type":"binary-expr","locations":[{"start":{"line":5,"column":14},"end":{"line":5,"column":33}},{"start":{"line":5,"column":37},"end":{"line":5,"column":43}}],"line":5},"1":{"loc":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"type":"binary-expr","locations":[{"start":{"line":6,"column":14},"end":{"line":6,"column":33}},{"start":{"line":6,"column":37},"end":{"line":6,"column":45}}],"line":6},"2":{"loc":{"start":{"line":7,"column":14},"end":{"line":7,"column":46}},"type":"binary-expr","locations":[{"start":{"line":7,"column":14},"end":{"line":7,"column":34}},{"start":{"line":7,"column":38},"end":{"line":7,"column":46}}],"line":7},"3":{"loc":{"start":{"line":8,"column":10},"end":{"line":8,"column":44}},"type":"binary-expr","locations":[{"start":{"line":8,"column":10},"end":{"line":8,"column":29}},{"start":{"line":8,"column":33},"end":{"line":8,"column":44}}],"line":8},"4":{"loc":{"start":{"line":9,"column":10},"end":{"line":9,"column":45}},"type":"binary-expr","locations":[{"start":{"line":9,"column":10},"end":{"line":9,"column":37}},{"start":{"line":9,"column":41},"end":{"line":9,"column":45}}],"line":9}},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{"0":[1,1],"1":[1,1],"2":[1,1],"3":[1,1],"4":[1,1]},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/database/config/database.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/database/config/database.ts"],"names":[],"mappings":";;AACA,OAAO,CAAC,eAAe,CAAC,CAAC;AAEzB,MAAM,MAAM,GAAY;IACtB,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,MAAM;IACvC,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,QAAQ;IACzC,QAAQ,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,IAAI,QAAQ;IAC1C,IAAI,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,IAAI,WAAW;IACxC,IAAI,EAAE,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,IAAI,IAAI;IACzC,OAAO,EAAE,UAAU;CACpB,CAAC;AAEF,MAAM,CAAC,OAAO,GAAG,MAAM,CAAC","sourcesContent":["import { Options } from 'sequelize';\nrequire('dotenv/config');\n\nconst config: Options = {\n  username: process.env.DB_USER || 'root',\n  password: process.env.DB_PASS || '123456',\n  database: process.env.DATABASE || 'NGCash',\n  host: process.env.DB_HOST || 'localhost',\n  port: Number(process.env.DB_PORT) || 3002,\n  dialect: 'postgres',\n};\n\nmodule.exports = config;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"17d2b91d1056d209a14f955d937cd43470eaad2b","contentHash":"60776976f10889fb9e70ca42c8a1c6a58e8a4b320aa8f060cf2a076b8872ee83"},"/home/gabriel/NG-Cash_desafio/api/src/database/models/Users.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/database/models/Users.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":20},"end":{"line":6,"column":40}},"4":{"start":{"line":7,"column":11},"end":{"line":7,"column":40}},"5":{"start":{"line":8,"column":19},"end":{"line":8,"column":57}},"6":{"start":{"line":11,"column":0},"end":{"line":34,"column":3}},"7":{"start":{"line":35,"column":0},"end":{"line":38,"column":3}},"8":{"start":{"line":39,"column":0},"end":{"line":42,"column":3}},"9":{"start":{"line":43,"column":0},"end":{"line":43,"column":24}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":2,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1},"f":{"0":2},"b":{"0":[1,1,1],"1":[2,0],"2":[2,2]},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/database/models/Users.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/database/models/Users.ts"],"names":[],"mappings":";;;;;AAAA,yCAEmB;AACnB,yCAAmB;AACnB,0DAAkC;AAElC,MAAM,KAAM,SAAQ,iBAAK;CAKxB;AACD,KAAK,CAAC,IAAI,CAAC;IACT,EAAE,EAAE;QACF,IAAI,EAAE,qBAAS,CAAC,OAAO;QACvB,SAAS,EAAE,KAAK;QAChB,aAAa,EAAE,IAAI;QACnB,UAAU,EAAE,IAAI;KACjB;IACD,QAAQ,EAAE,qBAAS,CAAC,MAAM;IAC1B,QAAQ,EAAE,qBAAS,CAAC,MAAM;IAC1B,SAAS,EAAE;QACT,IAAI,EAAE,qBAAS,CAAC,OAAO;QACvB,SAAS,EAAE,KAAK;QAChB,QAAQ,EAAE,SAAS;QACnB,QAAQ,EAAE,SAAS;QACnB,UAAU,EAAE;YACV,KAAK,EAAE,UAAU;YACjB,GAAG,EAAE,IAAI;SACV;KACF;CACF,EAAE;IACD,SAAS,EAAE,UAAE;IACb,SAAS,EAAE,OAAO;IAClB,UAAU,EAAE,KAAK;CAClB,CAAC,CAAC;AAEH,KAAK,CAAC,MAAM,CAAC,kBAAQ,EAAE;IACrB,UAAU,EAAE,IAAI;IAChB,EAAE,EAAE,SAAS;CACd,CAAC,CAAC;AAEH,kBAAQ,CAAC,SAAS,CAAC,KAAK,EAAE;IACxB,UAAU,EAAE,IAAI;IAChB,EAAE,EAAE,MAAM;CACX,CAAC,CAAC;AAEH,kBAAe,KAAK,CAAC","sourcesContent":["import {\n  Model, DataTypes,\n} from 'sequelize';\nimport db from '.';\nimport Accounts from './Accounts';\n\nclass Users extends Model {\n  public id!: number;\n  public username!: string;\n  public password!: string;\n  public accountId!: number;\n}\nUsers.init({\n  id: {\n    type: DataTypes.INTEGER,\n    allowNull: false,\n    autoIncrement: true,\n    primaryKey: true,\n  },\n  username: DataTypes.STRING,\n  password: DataTypes.STRING,\n  accountId: {\n    type: DataTypes.INTEGER,\n    allowNull: false,\n    onUpdate: 'CASCADE',\n    onDelete: 'CASCADE',\n    references: {\n      model: 'accounts',\n      key: 'id',\n    },\n  },\n}, {\n  sequelize: db,\n  modelName: 'users',\n  timestamps: false,\n});\n\nUsers.hasOne(Accounts, {\n  foreignKey: 'id',\n  as: 'account'\n});\n\nAccounts.belongsTo(Users, {\n  foreignKey: 'id',\n  as: 'user'\n});\n\nexport default Users;"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2462d7fb61fc492f4a8242ac31c4cd51e8e7a006","contentHash":"e8763d84a584219c200cc7d7645746f231a9edfc2f213e2bccfaf06ce61ffd72"},"/home/gabriel/NG-Cash_desafio/api/src/controllers/UserController.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/controllers/UserController.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":56}},"2":{"start":{"line":6,"column":8},"end":{"line":6,"column":33}},"3":{"start":{"line":9,"column":25},"end":{"line":9,"column":28}},"4":{"start":{"line":10,"column":23},"end":{"line":10,"column":55}},"5":{"start":{"line":11,"column":8},"end":{"line":11,"column":73}},"6":{"start":{"line":14,"column":23},"end":{"line":14,"column":33}},"7":{"start":{"line":15,"column":23},"end":{"line":15,"column":54}},"8":{"start":{"line":16,"column":8},"end":{"line":16,"column":68}},"9":{"start":{"line":19,"column":0},"end":{"line":19,"column":33}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":26},"end":{"line":7,"column":5}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":34},"end":{"line":12,"column":5}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":4},"end":{"line":13,"column":5}},"loc":{"start":{"line":13,"column":35},"end":{"line":17,"column":5}},"line":13}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":1},"f":{"0":1,"1":2,"2":2},"b":{},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/controllers/UserController.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/controllers/UserController.ts"],"names":[],"mappings":";;AAGA,yDAAgD;AAIhD,MAAqB,cAAc;IACjC,YAAoB,QACiD;QADjD,aAAQ,GAAR,QAAQ,CACyC;IAAE,CAAC;IAExE,KAAK,CAAC,MAAM,CAAC,GAAY,EAAE,GAAa,EAAE,KAAmB;QAC3D,MAAM,EAAE,IAAI,EAAE,GAAG,GAAG,CAAC;QACrB,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;QAChD,GAAG,CAAC,MAAM,CAAC,+BAAW,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC/C,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,GAAY,EAAE,GAAa,EAAE,KAAmB;QAC5D,MAAM,EAAE,EAAE,EAAE,GAAG,GAAG,CAAC,MAAM,CAAC;QAC1B,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;QAC/C,GAAG,CAAC,MAAM,CAAC,+BAAW,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC1C,CAAC;CACF;AAfD,iCAeC","sourcesContent":["import { Request, Response, NextFunction } from 'express';\nimport { Service } from '../interfaces/Service';\nimport { Controller } from '../interfaces/Controller';\nimport { StatusCodes } from 'http-status-codes';\nimport { IUserResponse } from '../interfaces/IUser';\nimport { Token } from '../interfaces/Token';\n\nexport default class UserController implements Omit<Controller, 'read' | 'update' | 'delete'> {\n  constructor(private _service: \n    Omit<Service<IUserResponse | Token>, 'read' | 'update' | 'delete' >){}\n\n  async create(req: Request, res: Response, _next: NextFunction): Promise<void> {\n    const { body } = req;\n    const result = await this._service.create(body);\n    res.status(StatusCodes.CREATED).json(result);\n  }\n\n  async readOne(req: Request, res: Response, _next: NextFunction): Promise<void> {\n    const { id } = req.params;\n    const result = await this._service.readOne(id);\n    res.status(StatusCodes.OK).json(result);\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"574b08a0ae606fc01c04ca4248a6e22cb05d2c18","contentHash":"ba9b6f706305dcbfa0cf0a7ba415544738e9e3c84fd34c9ac9894f54badd6472"},"/home/gabriel/NG-Cash_desafio/api/src/services/UserService.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/services/UserService.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"25":{"start":{"line":26,"column":4},"end":{"line":26,"column":62}},"26":{"start":{"line":28,"column":0},"end":{"line":28,"column":62}},"27":{"start":{"line":29,"column":15},"end":{"line":29,"column":46}},"28":{"start":{"line":30,"column":16},"end":{"line":30,"column":46}},"29":{"start":{"line":31,"column":16},"end":{"line":31,"column":68}},"30":{"start":{"line":32,"column":19},"end":{"line":32,"column":74}},"31":{"start":{"line":33,"column":17},"end":{"line":33,"column":63}},"32":{"start":{"line":34,"column":18},"end":{"line":34,"column":46}},"33":{"start":{"line":37,"column":8},"end":{"line":37,"column":29}},"34":{"start":{"line":38,"column":8},"end":{"line":38,"column":29}},"35":{"start":{"line":41,"column":39},"end":{"line":41,"column":64}},"36":{"start":{"line":42,"column":21},"end":{"line":42,"column":46}},"37":{"start":{"line":43,"column":8},"end":{"line":43,"column":46}},"38":{"start":{"line":44,"column":23},"end":{"line":50,"column":10}},"39":{"start":{"line":45,"column":28},"end":{"line":45,"column":79}},"40":{"start":{"line":46,"column":25},"end":{"line":48,"column":34}},"41":{"start":{"line":49,"column":12},"end":{"line":49,"column":24}},"42":{"start":{"line":51,"column":8},"end":{"line":51,"column":22}},"43":{"start":{"line":54,"column":22},"end":{"line":54,"column":58}},"44":{"start":{"line":55,"column":8},"end":{"line":56,"column":30}},"45":{"start":{"line":56,"column":12},"end":{"line":56,"column":30}},"46":{"start":{"line":57,"column":8},"end":{"line":57,"column":26}},"47":{"start":{"line":60,"column":27},"end":{"line":60,"column":29}},"48":{"start":{"line":61,"column":8},"end":{"line":61,"column":53}},"49":{"start":{"line":64,"column":28},"end":{"line":68,"column":10}},"50":{"start":{"line":69,"column":8},"end":{"line":70,"column":59}},"51":{"start":{"line":70,"column":12},"end":{"line":70,"column":59}},"52":{"start":{"line":73,"column":23},"end":{"line":80,"column":10}},"53":{"start":{"line":81,"column":8},"end":{"line":82,"column":65}},"54":{"start":{"line":82,"column":12},"end":{"line":82,"column":65}},"55":{"start":{"line":83,"column":8},"end":{"line":83,"column":22}},"56":{"start":{"line":86,"column":0},"end":{"line":86,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":56},"end":{"line":25,"column":57}},"loc":{"start":{"line":25,"column":71},"end":{"line":27,"column":1}},"line":25},"7":{"name":"(anonymous_7)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":42},"end":{"line":39,"column":5}},"line":36},"8":{"name":"(anonymous_8)","decl":{"start":{"line":40,"column":4},"end":{"line":40,"column":5}},"loc":{"start":{"line":40,"column":25},"end":{"line":52,"column":5}},"line":40},"9":{"name":"(anonymous_9)","decl":{"start":{"line":44,"column":58},"end":{"line":44,"column":59}},"loc":{"start":{"line":44,"column":71},"end":{"line":50,"column":9}},"line":44},"10":{"name":"(anonymous_10)","decl":{"start":{"line":53,"column":4},"end":{"line":53,"column":5}},"loc":{"start":{"line":53,"column":25},"end":{"line":58,"column":5}},"line":53},"11":{"name":"(anonymous_11)","decl":{"start":{"line":59,"column":4},"end":{"line":59,"column":5}},"loc":{"start":{"line":59,"column":25},"end":{"line":62,"column":5}},"line":59},"12":{"name":"(anonymous_12)","decl":{"start":{"line":63,"column":4},"end":{"line":63,"column":5}},"loc":{"start":{"line":63,"column":37},"end":{"line":71,"column":5}},"line":63},"13":{"name":"(anonymous_13)","decl":{"start":{"line":72,"column":4},"end":{"line":72,"column":5}},"loc":{"start":{"line":72,"column":22},"end":{"line":84,"column":5}},"line":72}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":25,"column":22},"end":{"line":27,"column":1}},"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":27}},{"start":{"line":25,"column":31},"end":{"line":25,"column":51}},{"start":{"line":25,"column":56},"end":{"line":27,"column":1}}],"line":25},"17":{"loc":{"start":{"line":26,"column":11},"end":{"line":26,"column":61}},"type":"cond-expr","locations":[{"start":{"line":26,"column":37},"end":{"line":26,"column":40}},{"start":{"line":26,"column":43},"end":{"line":26,"column":61}}],"line":26},"18":{"loc":{"start":{"line":26,"column":12},"end":{"line":26,"column":33}},"type":"binary-expr","locations":[{"start":{"line":26,"column":12},"end":{"line":26,"column":15}},{"start":{"line":26,"column":19},"end":{"line":26,"column":33}}],"line":26},"19":{"loc":{"start":{"line":36,"column":16},"end":{"line":36,"column":40}},"type":"default-arg","locations":[{"start":{"line":36,"column":25},"end":{"line":36,"column":40}}],"line":36},"20":{"loc":{"start":{"line":55,"column":8},"end":{"line":56,"column":30}},"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":56,"column":30}},{"start":{"line":55,"column":8},"end":{"line":56,"column":30}}],"line":55},"21":{"loc":{"start":{"line":69,"column":8},"end":{"line":70,"column":59}},"type":"if","locations":[{"start":{"line":69,"column":8},"end":{"line":70,"column":59}},{"start":{"line":69,"column":8},"end":{"line":70,"column":59}}],"line":69},"22":{"loc":{"start":{"line":81,"column":8},"end":{"line":82,"column":65}},"type":"if","locations":[{"start":{"line":81,"column":8},"end":{"line":82,"column":65}},{"start":{"line":81,"column":8},"end":{"line":82,"column":65}}],"line":81}},"s":{"0":1,"1":7,"2":7,"3":7,"4":7,"5":7,"6":0,"7":7,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":1,"15":1,"16":0,"17":1,"18":1,"19":1,"20":7,"21":7,"22":1,"23":1,"24":1,"25":3,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":1},"f":{"0":7,"1":0,"2":0,"3":1,"4":0,"5":1,"6":3,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[1,0],"2":[7,0],"3":[7,0],"4":[7,7],"5":[0,7],"6":[7,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,1],"13":[1,0],"14":[7,0],"15":[7,7],"16":[1,1,1],"17":[3,0],"18":[3,3],"19":[1],"20":[0,0],"21":[0,0],"22":[0,0]},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/services/UserService.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/services/UserService.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+CAAiC;AACjC,+CAAgE;AAChE,qEAA6C;AAC7C,2EAAmD;AAEnD,gEAA2C;AAC3C,+CAA+C;AAK/C,MAAqB,WAAW;IAE9B,YAAoB,SAAS,eAAK;QAAd,WAAM,GAAN,MAAM,CAAQ;QAChC,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;IACvB,CAAC;IAED,KAAK,CAAC,MAAM,CAAC,MAAe;QAC1B,MAAM,EAAC,QAAQ,EAAE,QAAQ,EAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;QACvD,MAAM,IAAI,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC;QACvC,MAAM,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QAEtC,MAAM,MAAM,GAAG,MAAM,gBAAS,CAAC,WAAW,CAAC,KAAK,EAAE,CAAC,EAAE,EAAE;YACrD,MAAM,OAAO,GAAG,MAAM,kBAAQ,CAAC,MAAM,CAAC,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC;YAC1D,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;gBACpC,QAAQ,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,CAAC,EAAE;aAChD,EAAE,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC;YACvB,OAAO,IAAI,CAAC;QACd,CAAC,CAAC,CAAC;QAEH,OAAO,MAA0B,CAAC;IACpC,CAAC;IAEO,YAAY,CAAC,MAAe;QAClC,MAAM,KAAK,GAAG,kBAAU,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAC3C,IAAG,CAAC,KAAK,CAAC,OAAO;YAAE,MAAM,KAAK,CAAC,KAAK,CAAC;QACrC,OAAO,KAAK,CAAC,IAAI,CAAC;IACpB,CAAC;IAEO,UAAU,CAAC,QAAgB;QACjC,MAAM,UAAU,GAAG,EAAE,CAAC;QACtB,OAAO,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;IAC/C,CAAC;IAEO,KAAK,CAAC,gBAAgB,CAAC,QAAgB;QAC7C,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;YAC5C,KAAK,EAAE;gBACL,QAAQ;aACT;SAAC,CAAC,CAAC;QAEN,IAAG,WAAW;YAAE,MAAM,KAAK,CAAC,oBAAU,CAAC,YAAY,CAAC,CAAC;IACvD,CAAC;IAED,KAAK,CAAC,OAAO,CAAC,EAAU;QACtB,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC;YACvC,KAAK,EAAE;gBACL,SAAS,EAAE,EAAE;aACd;YACD,UAAU,EAAE;gBACV,OAAO,EAAE,CAAC,UAAU,CAAC;aACtB;SACF,CAAC,CAAC;QACH,IAAI,CAAC,MAAM;YAAE,MAAM,IAAI,KAAK,CAAC,oBAAU,CAAC,cAAc,CAAC,CAAC;QACxD,OAAO,MAAM,CAAC;IAChB,CAAC;CACF;AAtDD,8BAsDC","sourcesContent":["import * as bcrypt from 'bcrypt';\nimport { IUserResponse, userSchema } from '../interfaces/IUser';\nimport Users from '../database/models/Users';\nimport Accounts from '../database/models/Accounts';\nimport { Service } from '../interfaces/Service';\nimport sequelize from '../database/models';\nimport { ErrorTypes } from '../errors/catalog';\nimport { Token } from '../interfaces/Token';\n\n\n\nexport default class UserService implements \nOmit<Service<IUserResponse | Token>, 'create' | 'read' | 'update' |'delete'> {\n  constructor(private _model = Users) {\n    this._model = _model;\n  }\n\n  async create(object: unknown): Promise<Token> {\n    const {password, username} = this.validateBody(object); \n    const hash = this.createHash(password);\n    await this.isUniqueUsername(username);\n\n    const result = await sequelize.transaction(async (t) => {\n      const account = await Accounts.create({ transaction: t });\n      const user = await this._model.create({\n        username, password: hash, accountId: account.id\n      }, { transaction: t });\n      return user;\n    });\n\n    return result as unknown as Token;\n  }\n\n  private validateBody(object: unknown) {\n    const parse = userSchema.safeParse(object);\n    if(!parse.success) throw parse.error;\n    return parse.data;\n  }\n\n  private createHash(password: string) {\n    const saltRounds = 10;\n    return bcrypt.hashSync(password, saltRounds);\n  }\n  \n  private async isUniqueUsername(username: string) {\n    const isNotUnique = await this._model.findOne({ \n      where: {\n        username,\n      }});\n  \n    if(isNotUnique) throw Error(ErrorTypes.AlreadyInUse);\n  }\n\n  async readOne(id: string): Promise<IUserResponse> {\n    const result = await this._model.findOne({\n      where: {\n        accountId: id\n      },\n      attributes: {\n        exclude: ['password']\n      }\n    });\n    if (!result) throw new Error(ErrorTypes.EntityNotFound);\n    return result;\n  }\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"363ff4ddb06131e8dc7f417427ce5c8c3efcb7b0","contentHash":"46b7fa4185fb6b422e7d6352339b152e67b2e198b4ac8ca4ab96aa7fcc8d3ca0"},"/home/gabriel/NG-Cash_desafio/api/src/interfaces/IUser.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/interfaces/IUser.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":28}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":28}},"3":{"start":{"line":5,"column":32},"end":{"line":5,"column":61}},"4":{"start":{"line":6,"column":0},"end":{"line":11,"column":3}},"5":{"start":{"line":8,"column":54},"end":{"line":8,"column":87}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":45},"end":{"line":8,"column":46}},"loc":{"start":{"line":8,"column":54},"end":{"line":8,"column":87}},"line":8}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/interfaces/IUser.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/interfaces/IUser.ts"],"names":[],"mappings":";;;AAAA,6BAAwB;AAExB,MAAM,uBAAuB,GAAG,6BAA6B,CAAC;AAEjD,QAAA,UAAU,GAAE,OAAC,CAAC,MAAM,CAAC;IAChC,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;IAC3B,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,uBAAuB,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;QAC7E,OAAO,EAAE,6EAA6E;KACvF,CAAC;CACH,CAAC,CAAC","sourcesContent":["import { z } from 'zod';\n\nconst passwordValidationRegex = /(?=.*\\d)(?=.*[A-Z])(?=.*\\W)/;\n\nexport const userSchema= z.object({\n  username: z.string().min(3),\n  password: z.string().min(8).refine((str) => passwordValidationRegex.test(str), {\n    message: 'a senha deve conter ao menos um número, letra maiúscula e caracter especial',\n  })\n});\n\nexport type IUser = z.infer<typeof userSchema>\n\nexport type IUserResponse = {\n  id: number,\n  username: string,\n  accountId: number\n}\n\nexport type ReqUser = {\n  username: string,\n  accountId: number\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c6028189165f49c313ffb7923ca132b06529dcee","contentHash":"be6166972a1c44f535b4ed1e11590a1298e953772b51246642296775c682b6bf"},"/home/gabriel/NG-Cash_desafio/api/src/errors/catalog.ts":{"path":"/home/gabriel/NG-Cash_desafio/api/src/errors/catalog.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":51}},"2":{"start":{"line":4,"column":28},"end":{"line":4,"column":56}},"3":{"start":{"line":6,"column":0},"end":{"line":14,"column":65}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":52}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":52}},"6":{"start":{"line":9,"column":4},"end":{"line":9,"column":48}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":48}},"8":{"start":{"line":11,"column":4},"end":{"line":11,"column":56}},"9":{"start":{"line":12,"column":4},"end":{"line":12,"column":58}},"10":{"start":{"line":13,"column":4},"end":{"line":13,"column":42}},"11":{"start":{"line":15,"column":0},"end":{"line":44,"column":2}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":1},"end":{"line":6,"column":2}},"loc":{"start":{"line":6,"column":23},"end":{"line":14,"column":1}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":14,"column":16},"end":{"line":14,"column":63}},"type":"binary-expr","locations":[{"start":{"line":14,"column":16},"end":{"line":14,"column":34}},{"start":{"line":14,"column":39},"end":{"line":14,"column":62}}],"line":14}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"/home/gabriel/NG-Cash_desafio/api/src/errors/catalog.ts","sources":["/home/gabriel/NG-Cash_desafio/api/src/errors/catalog.ts"],"names":[],"mappings":";;;AAAA,yDAAgD;AAEhD,IAAY,UAQX;AARD,WAAY,UAAU;IACpB,+CAAiC,CAAA;IACjC,+CAAiC,CAAA;IACjC,2CAA6B,CAAA;IAC7B,2CAA6B,CAAA;IAC7B,mDAAqC,CAAA;IACrC,qDAAuC,CAAA;IACvC,qCAAuB,CAAA;AACzB,CAAC,EARW,UAAU,GAAV,kBAAU,KAAV,kBAAU,QAQrB;AASY,QAAA,YAAY,GAAiB;IACxC,cAAc,EAAE;QACd,OAAO,EAAE,kBAAkB;QAC3B,UAAU,EAAE,+BAAW,CAAC,WAAW;KACpC;IACD,cAAc,EAAE;QACd,OAAO,EAAE,kBAAkB;QAC3B,UAAU,EAAE,+BAAW,CAAC,SAAS;KAClC;IACD,YAAY,EAAE;QACZ,OAAO,EAAE,qBAAqB;QAC9B,UAAU,EAAE,+BAAW,CAAC,WAAW;KACpC;IACD,YAAY,EAAE;QACZ,OAAO,EAAE,qBAAqB;QAC9B,UAAU,EAAE,+BAAW,CAAC,YAAY;KACrC;IACD,gBAAgB,EAAE;QAChB,OAAO,EAAE,4BAA4B;QACrC,UAAU,EAAE,+BAAW,CAAC,YAAY;KACrC;IACD,iBAAiB,EAAE;QACjB,OAAO,EAAE,oBAAoB;QAC7B,UAAU,EAAE,+BAAW,CAAC,WAAW;KACpC;IACD,SAAS,EAAE;QACT,OAAO,EAAE,wBAAwB;QACjC,UAAU,EAAE,+BAAW,CAAC,SAAS;KAClC;CACF,CAAC","sourcesContent":["import { StatusCodes } from 'http-status-codes';\n\nexport enum ErrorTypes {\n  EntityNotFound = 'EntityNotFound',\n  ObjectNotFound = 'ObjectNotFound',\n  AlreadyInUse = 'AlreadyInUse',\n  InvalidToken = 'InvalidToken',\n  WrongCredentials = 'WrongCredentials',\n  InsufficientFunds = 'InsufficientFunds',\n  Forbidden = 'Forbidden'\n}\n\ntype ErrorResponseObject = { \n  message: string;\n  httpStatus: number\n};\n\nexport type ErrorCatalog = Record<ErrorTypes, ErrorResponseObject>;\n\nexport const errorCatalog: ErrorCatalog = {\n  EntityNotFound: {\n    message: 'Entity not found',\n    httpStatus: StatusCodes.BAD_REQUEST,\n  },\n  ObjectNotFound: {\n    message: 'Object not found',\n    httpStatus: StatusCodes.NOT_FOUND,\n  },\n  AlreadyInUse: {\n    message: 'User already in use',\n    httpStatus: StatusCodes.BAD_REQUEST\n  },\n  InvalidToken: {\n    message: 'Token must be valid',\n    httpStatus: StatusCodes.UNAUTHORIZED\n  },\n  WrongCredentials: {\n    message: 'Wrong username or password',\n    httpStatus: StatusCodes.UNAUTHORIZED\n  },\n  InsufficientFunds: {\n    message: 'Insufficient funds',\n    httpStatus: StatusCodes.BAD_REQUEST\n  },\n  Forbidden: {\n    message: 'Operation not possible',\n    httpStatus: StatusCodes.FORBIDDEN\n  }\n};"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"be2484940d82036e4d72ffeae7c0a1ce5e774e82","contentHash":"926527924cb3351d66112e485f0484f881bf68488ef14d4d1adfc70823b98911"}}